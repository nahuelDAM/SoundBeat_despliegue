import{a as p}from"./chunk-X6RIFEDY.js";import{b as a,c as n}from"./chunk-5NEJBAS5.js";import{d as u,f as s,o as c,r as l,s as h}from"./chunk-YSYQHBOM.js";var b=(()=>{let t=class t{constructor(e){this.loginService=e,this._currentUser=new u(null),this.currentUser$=this._currentUser.asObservable(),this.loginService.idUsuario$.subscribe(r=>{r?this.loadCurrentUser(r):this.clearCurrentUser()})}loadCurrentUser(e){if(!e){this.clearCurrentUser();return}this.obtenerUsuarioPorId(e).pipe(c(r=>console.log("UsuarioService: Datos de usuario cargados:",r))).subscribe({next:r=>{this._currentUser.next(r)},error:r=>{console.error("UsuarioService: Error al cargar usuario:",r),this.clearCurrentUser()}})}_getAuthHeaders(){let e=localStorage.getItem("token"),r={"Content-Type":"application/json"};return e&&(r.Authorization=`Bearer ${e}`),r}obtenerUsuarioPorId(e){let r=`${n.URLbase}/api/usuarios/${e}`;return s(a.get({url:r,headers:this._getAuthHeaders()}).then(i=>i.data))}actualizarPerfil(e){let r=`${n.URLbase}/api/usuarios/perfil`;return console.log("Actualizando perfil con datos:",e),s(a.put({url:r,headers:this._getAuthHeaders(),data:e}).then(i=>i.data))}clearCurrentUser(){this._currentUser.next(null),console.log("UsuarioService: Datos de usuario limpiados.")}};t.\u0275fac=function(r){return new(r||t)(h(p))},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();export{b as a};
