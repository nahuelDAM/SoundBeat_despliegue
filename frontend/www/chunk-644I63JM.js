import{a as ee}from"./chunk-7RXKWNF4.js";import{a as J}from"./chunk-ASUOXMFU.js";import"./chunk-5NEJBAS5.js";import{Aa as I,Bb as z,Ea as V,F as a,Fc as Q,Ga as T,H as m,J as O,Jb as A,La as D,M as x,O as c,Oa as E,Pa as R,Q as y,R as v,Ra as q,Rc as X,S as n,Sb as j,Sc as Y,T as i,Ta as F,U as w,Ua as L,Ub as B,Y as _,Z as P,Za as W,Zc as $,_ as g,a as k,ab as N,fc as U,ga as l,la as C,ma as M,na as b,oc as G,qc as H,rc as Z,v as h,w as f,wc as K,xa as S}from"./chunk-XCE7OHUN.js";import"./chunk-B6B5UJKW.js";import"./chunk-ZGM7264U.js";import"./chunk-YKTCUWBK.js";import"./chunk-WS3OVXI4.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-OWSRRI5Z.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as u}from"./chunk-RW4GY4BD.js";function oe(o,d){if(o&1){let r=_();n(0,"ion-input",19),b("ngModelChange",function(t){h(r);let e=g();return M(e.password,t)||(e.password=t),f(t)}),i()}if(o&2){let r=g();C("ngModel",r.password)}}function re(o,d){if(o&1){let r=_();n(0,"ion-input",20),b("ngModelChange",function(t){h(r);let e=g();return M(e.password,t)||(e.password=t),f(t)}),i()}if(o&2){let r=g();C("ngModel",r.password)}}function ae(o,d){if(o&1){let r=_();n(0,"ion-input",21),b("ngModelChange",function(t){h(r);let e=g();return M(e.confirmPassword,t)||(e.confirmPassword=t),f(t)}),i()}if(o&2){let r=g();C("ngModel",r.confirmPassword)}}function se(o,d){if(o&1){let r=_();n(0,"ion-input",22),b("ngModelChange",function(t){h(r);let e=g();return M(e.confirmPassword,t)||(e.confirmPassword=t),f(t)}),i()}if(o&2){let r=g();C("ngModel",r.confirmPassword)}}function le(o,d){o&1&&(n(0,"ion-text",23)(1,"p"),l(2,"Las contrase\xF1as no coinciden."),i()())}var ke=(()=>{let d=class d{constructor(s,t,e,p,te,ne){this.route=s,this.loginService=t,this.toastController=e,this.loadingController=p,this.router=te,this.themeService=ne,this.password="",this.confirmPassword="",this.token=null,this.isDarkMode=!1,this.passwordVisible=!1,this.confirmPasswordVisible=!1,this.loading=!1,this.themeSubscription=new k,this.themeSubscription=this.themeService.isDarkMode().subscribe(ie=>{this.isDarkMode=ie}),K({keyOutline:$,checkmarkOutline:Q,eyeOffOutline:X,eyeOutline:Y})}ngOnInit(){this.token=this.route.snapshot.queryParamMap.get("token"),console.log("Token capturado de la URL:",this.token),this.token||(this.presentToast("Enlace no v\xE1lido o expirado.","danger"),this.router.navigate(["/login"]))}ngOnDestroy(){this.themeSubscription.unsubscribe()}hasMinLength(){return!!this.password&&this.password.length>=8}hasUpperCase(){return!!this.password&&/[A-Z]/.test(this.password||"")}hasNumber(){return!!this.password&&/[0-9]/.test(this.password)}passwordsMatch(){return!!this.password&&!!this.confirmPassword&&this.password===this.confirmPassword}actualizarPassword(){return u(this,null,function*(){if(!this.validarFormulario())return;this.loading=!0;let s=yield this.loadingController.create({message:"Actualizando contrase\xF1a...",spinner:"crescent"});yield s.present(),this.token&&this.loginService.resetPassword(this.token,this.password).subscribe({next:()=>u(this,null,function*(){yield s.dismiss(),this.loading=!1,yield this.presentToast("\xA1Contrase\xF1a actualizada con \xE9xito!","success"),this.router.navigate(["/login"])}),error:t=>u(this,null,function*(){var e;yield s.dismiss(),this.loading=!1,yield this.presentToast(((e=t.error)==null?void 0:e.error)||"El enlace es inv\xE1lido o ha expirado.","danger")})})})}validarFormulario(){return!this.password||!this.confirmPassword?(this.presentToast("Por favor, completa todos los campos.","danger"),!1):this.password!==this.confirmPassword?(this.presentToast("Las contrase\xF1as no coinciden.","danger"),!1):this.password.length<8?(this.presentToast("La contrase\xF1a debe tener al menos 8 caracteres.","danger"),!1):!0}presentToast(s,t){return u(this,null,function*(){(yield this.toastController.create({message:s,duration:3500,position:"top",color:t,cssClass:this.isDarkMode?"toast-dark":"toast-light"})).present()})}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}toggleConfirmPasswordVisibility(){this.confirmPasswordVisible=!this.confirmPasswordVisible}login(){this.router.navigate(["/login"])}};d.\u0275fac=function(t){return new(t||d)(m(V),m(J),m(H),m(G),m(T),m(ee))},d.\u0275cmp=O({type:d,selectors:[["app-reset-password"]],decls:43,vars:21,consts:[[1,"ion-padding",3,"fullscreen"],[1,"container"],[1,"header-container"],["name","key-outline",1,"header-icon"],[3,"ngSubmit"],["position","stacked"],["type","password","ngDefaultControl","","name","password","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","ngDefaultControl","","name","password","required","",3,"ngModel","ngModelChange",4,"ngIf"],["fill","clear","slot","end",3,"click"],[3,"name"],["type","password","ngDefaultControl","","name","confirmPassword","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","ngDefaultControl","","name","confirmPassword","required","",3,"ngModel","ngModelChange",4,"ngIf"],["color","danger","class","error-message",4,"ngIf"],[1,"password-requirements"],[1,"button-container"],["type","submit","expand","block",1,"submit-button",3,"disabled"],["name","checkmark-outline","slot","start"],[1,"help-text"],[3,"click"],["type","password","ngDefaultControl","","name","password","required","",3,"ngModelChange","ngModel"],["type","text","ngDefaultControl","","name","password","required","",3,"ngModelChange","ngModel"],["type","password","ngDefaultControl","","name","confirmPassword","required","",3,"ngModelChange","ngModel"],["type","text","ngDefaultControl","","name","confirmPassword","required","",3,"ngModelChange","ngModel"],["color","danger",1,"error-message"]],template:function(t,e){t&1&&(n(0,"ion-content",0)(1,"div",1)(2,"div",2),w(3,"ion-icon",3),n(4,"h2"),l(5,"Crea tu nueva contrase\xF1a"),i(),n(6,"p"),l(7,"Por favor, introduce una contrase\xF1a segura para tu cuenta."),i()(),n(8,"form",4),P("ngSubmit",function(){return e.actualizarPassword()}),n(9,"ion-item")(10,"ion-label",5),l(11,"Nueva Contrase\xF1a"),i(),x(12,oe,1,1,"ion-input",6)(13,re,1,1,"ion-input",7),n(14,"ion-button",8),P("click",function(){return e.togglePasswordVisibility()}),w(15,"ion-icon",9),i()(),n(16,"ion-item")(17,"ion-label",5),l(18,"Confirmar Contrase\xF1a"),i(),x(19,ae,1,1,"ion-input",10)(20,se,1,1,"ion-input",11),n(21,"ion-button",8),P("click",function(){return e.toggleConfirmPasswordVisibility()}),w(22,"ion-icon",9),i()(),x(23,le,3,0,"ion-text",12),n(24,"div",13)(25,"p"),l(26,"La contrase\xF1a debe:"),i(),n(27,"ul")(28,"li"),l(29,"Tener al menos 8 caracteres"),i(),n(30,"li"),l(31,"Incluir al menos una may\xFAscula"),i(),n(32,"li"),l(33,"Incluir al menos un n\xFAmero"),i()()(),n(34,"div",14)(35,"ion-button",15),w(36,"ion-icon",16),l(37," Actualizar Contrase\xF1a "),i()()(),n(38,"div",17)(39,"p"),l(40,"\xBFRecordaste tu contrase\xF1a? "),n(41,"a",18),P("click",function(){return e.login()}),l(42,"Iniciar sesi\xF3n"),i()()()()()),t&2&&(v(e.isDarkMode?"dark-theme":"light-theme"),c("fullscreen",!0),a(9),v(e.isDarkMode?"ion-item-dark":""),a(3),c("ngIf",!e.passwordVisible),a(),c("ngIf",e.passwordVisible),a(2),c("name",e.passwordVisible?"eye-outline":"eye-off-outline"),a(),v(e.isDarkMode?"ion-item-dark":""),a(3),c("ngIf",!e.confirmPasswordVisible),a(),c("ngIf",e.confirmPasswordVisible),a(2),c("name",e.confirmPasswordVisible?"eye-outline":"eye-off-outline"),a(),c("ngIf",e.password&&e.confirmPassword&&!e.passwordsMatch()),a(5),y("valid",e.hasMinLength()),a(2),y("valid",e.hasUpperCase()),a(2),y("valid",e.hasNumber()),a(3),c("disabled",!e.password||!e.confirmPassword||!e.passwordsMatch()))},dependencies:[B,j,U,Z,z,A,I,S,N,L,D,E,R,W,F,q],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;max-width:500px;margin:0 auto}.header-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px}.header-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;font-weight:600;margin-bottom:8px}.header-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin-bottom:16px}.header-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-primary);margin-bottom:16px}ion-item[_ngcontent-%COMP%]{--border-radius: 8px;--padding-start: 12px;margin-bottom:16px}ion-item.ion-item-dark[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .1)}.error-message[_ngcontent-%COMP%]{margin-left:16px;font-size:14px}.password-requirements[_ngcontent-%COMP%]{margin:16px 0;padding:16px;border-radius:8px;background-color:rgba(var(--ion-color-primary-rgb),.1)}.password-requirements[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:500}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:20px;margin:0}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px;color:var(--ion-color-medium)}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.valid[_ngcontent-%COMP%]{color:var(--ion-color-success)}.button-container[_ngcontent-%COMP%]{margin-top:24px}.submit-button[_ngcontent-%COMP%]{height:48px;font-weight:500;--border-radius: 8px;margin-bottom:16px}.help-text[_ngcontent-%COMP%]{text-align:center;margin-top:24px}.help-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium)}.help-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500}.dark-theme[_ngcontent-%COMP%]{--background: var(--ion-color-dark);--color: var(--ion-color-light)}.dark-theme[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .1);--color: var(--ion-color-light)}.dark-theme[_ngcontent-%COMP%]   .password-requirements[_ngcontent-%COMP%]{background-color:#ffffff1a}.light-theme[_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-dark)}.toast-dark[_ngcontent-%COMP%]{--background: var(--ion-color-dark);--color: var(--ion-color-light)}.toast-light[_ngcontent-%COMP%]{--background: var(--ion-color-light);--color: var(--ion-color-dark)}"]});let o=d;return o})();export{ke as ResetPasswordPage};
