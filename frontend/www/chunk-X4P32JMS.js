import{c as q,d as P,f as v,g as M}from"./chunk-FFJHRTPG.js";import{a as H}from"./chunk-X6RIFEDY.js";import"./chunk-5NEJBAS5.js";import{Aa as F,Bb as N,Ec as J,F as c,Ga as w,Gd as Q,J as k,Jb as Y,Lc as K,M as _,Na as h,O as m,Oa as I,Pa as S,Q as p,Qa as T,Rb as V,S as r,Sa as C,Sb as D,T as a,U as b,Ua as E,Ub as G,Va as L,Wa as A,Z as u,ab as j,bb as z,ga as d,nc as B,qc as R,sc as U,t as f,xa as y,xc as $}from"./chunk-YSYQHBOM.js";import"./chunk-B6B5UJKW.js";import"./chunk-ZGM7264U.js";import"./chunk-YKTCUWBK.js";import"./chunk-WS3OVXI4.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-OWSRRI5Z.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as O}from"./chunk-RW4GY4BD.js";function W(s,l){s&1&&(r(0,"div",17),d(1," Por favor, introduce un email v\xE1lido "),a()),s&2&&m("@fadeInOut",void 0)}function X(s,l){s&1&&(r(0,"div",17),d(1," La contrase\xF1a debe tener al menos 6 caracteres "),a()),s&2&&m("@fadeInOut",void 0)}var vt=(()=>{let l=class l{constructor(){this.formSubmitAttempt=!1,this.cardAnimated=!1,this.darkMode=!1,this.loginService=f(H),this.router=f(w),this.toastController=f(R),this.animationCtrl=f(B),this.loginForm=new T({email:new C("",[h.required,h.email]),password:new C("",[h.required,h.minLength(6)])}),$({checkmarkCircle:J,closeCircle:K,sunnyOutline:Q});let e=localStorage.getItem("darkMode");this.darkMode=e==="true"}ionViewDidEnter(){this.cardAnimated=!0}ngOnInit(){}toggleTheme(){this.darkMode=!this.darkMode,localStorage.setItem("darkMode",this.darkMode.toString())}isFieldValid(e){var n,t,i,o;return((t=(n=this.loginForm.get(e))==null?void 0:n.valid)!=null?t:!1)&&((o=(i=this.loginForm.get(e))==null?void 0:i.touched)!=null?o:!1)}isFieldInvalid(e){var n,t,i,o,g,x;return((t=(n=this.loginForm.get(e))==null?void 0:n.invalid)!=null?t:!1)&&((o=(i=this.loginForm.get(e))==null?void 0:i.touched)!=null?o:!1)||((x=(g=this.loginForm.get(e))==null?void 0:g.invalid)!=null?x:!1)&&this.formSubmitAttempt}isFieldTouched(e){var n;return((n=this.loginForm.get(e))==null?void 0:n.touched)||this.formSubmitAttempt}validateField(e){let n=this.loginForm.get(e);n&&n.markAsTouched()}login(){var t,i;this.formSubmitAttempt=!0;let e=(t=this.loginForm.get("email"))==null?void 0:t.value,n=(i=this.loginForm.get("password"))==null?void 0:i.value;this.loginForm.valid&&this.validarEmail(e)?this.loginService.login(e,n).subscribe({next:o=>{console.log("Login successful:",o),o.token?(console.log("Login successful:",o),this.loginService.guardarToken(o.token),this.loginService.guardarIdUsuario(o.userId),this.loginService.guardarRolUsuario(o.rol),this.cardAnimated=!1,setTimeout(()=>{this.router.navigate(["/menu"])},300)):this.mensajeToast("Login error: Email o contrase\xF1a incorrectos")},error:o=>{this.mensajeToast("Login error: Email o contrase\xF1a incorrectos"),console.log("Login error:",o)}}):this.validarEmail(e)?Object.keys(this.loginForm.controls).forEach(o=>{let g=this.loginForm.get(o);g==null||g.markAsTouched()}):this.mensajeToast("Invalid email.")}validarEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}mensajeToast(e){return O(this,null,function*(){yield(yield this.toastController.create({message:e,duration:2e3,color:"danger",position:"bottom",cssClass:"custom-toast"})).present()})}registrarse(){this.cardAnimated=!1,setTimeout(()=>{this.router.navigate(["/register"])},300)}recuperarPassword(){this.cardAnimated=!1,setTimeout(()=>{this.router.navigate(["/forgot-password"])},300)}};l.\u0275fac=function(n){return new(n||l)},l.\u0275cmp=k({type:l,selectors:[["app-login"]],decls:26,vars:19,consts:[[3,"fullscreen"],[1,"content-container"],[1,"login-card"],[1,"logo-container"],["src","../../assets/img/logo.png","alt","Logo"],[3,"ngSubmit","formGroup"],[1,"welcome-title"],[1,"form-item"],["label","Email","labelPlacement","floating","fill","outline","formControlName","email",1,"custom-input",3,"ionInput"],["class","error-message",4,"ngIf"],["label","Contrase\xF1a","labelPlacement","floating","fill","outline","type","password","formControlName","password",1,"custom-input",3,"ionInput"],["slot","end","color","pink"],[1,"forgot-password"],[3,"click"],[1,"button-container"],["expand","full","shape","round","type","submit",1,"submit-button",3,"disabled"],[1,"register-link"],[1,"error-message"]],template:function(n,t){n&1&&(r(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3),b(4,"img",4),a(),r(5,"form",5),u("ngSubmit",function(){return t.login()}),r(6,"h2",6),d(7,"\xA1Bienvenido!"),a(),r(8,"ion-item",7)(9,"ion-input",8),u("ionInput",function(){return t.validateField("email")}),a()(),_(10,W,2,1,"div",9),r(11,"ion-item",7)(12,"ion-input",10),u("ionInput",function(){return t.validateField("password")}),b(13,"ion-input-password-toggle",11),a()(),_(14,X,2,1,"div",9),r(15,"div",12)(16,"ion-label",13),u("click",function(){return t.recuperarPassword()}),d(17,"\xBFOlvidaste tu contrase\xF1a?"),a()(),r(18,"div",14)(19,"ion-button",15),d(20," Iniciar sesi\xF3n "),a()(),r(21,"div",16)(22,"ion-label"),d(23," \xBFNo tienes una cuenta? "),r(24,"span",13),u("click",function(){return t.registrarse()}),d(25,"Reg\xEDstrate"),a()()()()()()()),n&2&&(p("dark-mode",t.darkMode),m("fullscreen",!0),c(2),p("animate-in",t.cardAnimated),c(3),m("formGroup",t.loginForm),c(3),p("valid-input",t.isFieldValid("email"))("invalid-input",t.isFieldInvalid("email")),c(2),m("ngIf",t.isFieldInvalid("email")&&t.isFieldTouched("email")),c(),p("valid-input",t.isFieldValid("password"))("invalid-input",t.isFieldInvalid("password")),c(3),m("ngIf",t.isFieldInvalid("password")&&t.isFieldTouched("password")),c(5),p("button-shake",t.formSubmitAttempt&&t.loginForm.invalid),m("disabled",t.loginForm.invalid))},dependencies:[D,G,N,Y,F,y,j,E,I,S,z,L,A,V,U],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: var(--background-color);font-family:Poppins,sans-serif;transition:all .3s ease}.theme-toggle[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;z-index:100;background-color:var(--card-background);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 10px #0000001a;cursor:pointer;transition:all .3s ease}.theme-toggle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--primary-color)}.content-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;padding:20px}.login-card[_ngcontent-%COMP%]{background-color:var(--card-background);border-radius:16px;padding:30px 20px;width:100%;max-width:400px;box-shadow:var(--card-shadow);transition:all .3s ease;opacity:0;transform:translateY(20px)}.animate-in[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.logo-container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.logo-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:150px;height:auto;transition:all .3s ease}.welcome-title[_ngcontent-%COMP%]{color:var(--primary-color);font-family:Montserrat,sans-serif;font-size:28px;font-weight:600;text-align:center;margin-bottom:25px;transition:color .3s ease}ion-item.form-item[_ngcontent-%COMP%]{--background: transparent;--border-color: transparent;--border-width: 0;--inner-border-width: 0;--padding-start: 0;--padding-end: 0;--min-height: 70px;margin-bottom:20px;position:relative}.custom-input[_ngcontent-%COMP%]{--background: var(--input-background, #f0f0f0);--color: var(--input-text, #333333);--placeholder-color: var(--input-placeholder, #9e9e9e);--border-radius: 8px;--padding-start: 15px;--padding-end: 15px;--padding-top: 0;--padding-bottom: 0;--highlight-color: var(--primary-color, #e491b4)}.custom-input[_ngcontent-%COMP%]::part(native){padding-top:0;padding-bottom:0;min-height:48px;display:flex;align-items:center}ion-input.has-focus[_ngcontent-%COMP%]::part(label), ion-input.has-value[_ngcontent-%COMP%]::part(label){transform:translateY(-12px) scale(.75)}ion-input[_ngcontent-%COMP%]::part(input){margin-top:0;margin-bottom:0;height:100%;display:flex;align-items:center}.valid-input[_ngcontent-%COMP%]   .custom-input[_ngcontent-%COMP%]{--border-color: var(--success-color);--highlight-color: var(--success-color)}.invalid-input[_ngcontent-%COMP%]   .custom-input[_ngcontent-%COMP%]{--border-color: var(--error-color);--highlight-color: var(--error-color)}.validation-icon[_ngcontent-%COMP%]{position:absolute;right:40px;top:50%;transform:translateY(-50%);z-index:10}.validation-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;transition:all .3s ease}.validation-icon[_ngcontent-%COMP%]   ion-icon[name=checkmark-circle][_ngcontent-%COMP%]{color:var(--success-color)}.validation-icon[_ngcontent-%COMP%]   ion-icon[name=close-circle][_ngcontent-%COMP%]{color:var(--error-color)}.error-message[_ngcontent-%COMP%]{color:var(--error-color);font-size:12px;margin-top:-15px;margin-bottom:15px;padding-left:15px;text-align:left}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px}.forgot-password[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--primary-color);font-size:14px;font-weight:500;cursor:pointer;transition:color .3s ease}.button-container[_ngcontent-%COMP%]{margin-bottom:20px}ion-button[_ngcontent-%COMP%]{--background: var(--primary-color);--background-hover: var(--primary-color-hover);--color: #ffffff;--border-radius: 50px;--padding-top: 15px;--padding-bottom: 15px;font-weight:600;text-transform:uppercase;letter-spacing:1px;transition:all .3s ease;overflow:hidden}.submit-button[_ngcontent-%COMP%]{position:relative}.submit-button[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;width:5px;height:5px;background:#ffffff80;opacity:0;border-radius:100%;transform:scale(1) translate(-50%);transform-origin:50% 50%}.submit-button[_ngcontent-%COMP%]:focus:not(:active):after{animation:_ngcontent-%COMP%_ripple 1s ease-out}.button-shake[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .5s cubic-bezier(.36,.07,.19,.97) both}.register-link[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]{text-align:center}.register-link[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--text-color);font-size:14px;transition:color .3s ease}.register-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .login-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--primary-color);font-weight:600;cursor:pointer;transition:color .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(2px,0,0)}30%,50%,70%{transform:translate3d(-4px,0,0)}40%,60%{transform:translate3d(4px,0,0)}}@keyframes _ngcontent-%COMP%_ripple{0%{transform:scale(0);opacity:1}20%{transform:scale(25);opacity:1}to{opacity:0;transform:scale(40)}}'],data:{animation:[q("fadeInOut",[M(":enter",[v({opacity:0,transform:"translateY(-10px)"}),P("200ms ease-out",v({opacity:1,transform:"translateY(0)"}))]),M(":leave",[P("200ms ease-in",v({opacity:0,transform:"translateY(-10px)"}))])])]}});let s=l;return s})();export{vt as LoginPage};
