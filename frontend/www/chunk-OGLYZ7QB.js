import{a as $}from"./chunk-KAPDLRD4.js";import{a as re}from"./chunk-XTSUAW32.js";import"./chunk-5NEJBAS5.js";import{$c as oe,Ab as L,D as s,Ea as k,F as y,H as v,Hb as j,Ja as T,K as x,M as r,Ma as V,Mb as H,Na as D,O as M,Pa as F,Q as i,Qb as R,Qc as ne,R as a,Ra as E,Rc as ie,S as f,Sa as W,Sb as U,Tb as Y,W as w,X as h,Xa as z,Y as g,_a as A,ac as G,da as O,ea as m,ec as J,fc as K,gc as Q,ja as _,ka as P,la as C,pc as X,qb as B,qc as Z,t as c,u,va as I,vb as N,vc as ee,xc as te,ya as S,zb as q}from"./chunk-5RLBJS7C.js";import"./chunk-B6B5UJKW.js";import"./chunk-ZGM7264U.js";import"./chunk-YKTCUWBK.js";import"./chunk-WS3OVXI4.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-OWSRRI5Z.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function ae(o,l){if(o&1){let n=w();i(0,"ion-input",32),C("ngModelChange",function(t){c(n);let e=g();return P(e.currentPassword,t)||(e.currentPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.currentPassword),r("disabled",n.submitting)}}function se(o,l){if(o&1){let n=w();i(0,"ion-input",33),C("ngModelChange",function(t){c(n);let e=g();return P(e.currentPassword,t)||(e.currentPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.currentPassword),r("disabled",n.submitting)}}function de(o,l){if(o&1){let n=w();i(0,"ion-input",34),C("ngModelChange",function(t){c(n);let e=g();return P(e.newPassword,t)||(e.newPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.newPassword),r("disabled",n.submitting)}}function le(o,l){if(o&1){let n=w();i(0,"ion-input",35),C("ngModelChange",function(t){c(n);let e=g();return P(e.newPassword,t)||(e.newPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.newPassword),r("disabled",n.submitting)}}function ce(o,l){if(o&1){let n=w();i(0,"ion-input",36),C("ngModelChange",function(t){c(n);let e=g();return P(e.confirmPassword,t)||(e.confirmPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.confirmPassword),r("disabled",n.submitting)}}function ue(o,l){if(o&1){let n=w();i(0,"ion-input",37),C("ngModelChange",function(t){c(n);let e=g();return P(e.confirmPassword,t)||(e.confirmPassword=t),u(t)}),a()}if(o&2){let n=g();_("ngModel",n.confirmPassword),r("disabled",n.submitting)}}function ge(o,l){o&1&&f(0,"ion-spinner",38)}function pe(o,l){o&1&&(i(0,"span"),m(1,"Actualizar Contrase\xF1a"),a())}var ve=(()=>{let l=class l{constructor(d,t,e){this.router=d,this.themeService=t,this.autenticacionService=e,this.currentPassword="",this.newPassword="",this.confirmPassword="",this.showCurrentPassword=!1,this.showNewPassword=!1,this.showConfirmPassword=!1,this.submitting=!1,this.darkMode=!1,this.isAlertOpen=!1,this.alertMessage="",this.alertHeader="",this.alertButtons=[],this.isToastOpen=!1,this.toastMessage="",this.toastColor="success",this.subscriptions=[],ee({lockClosedOutline:oe,eyeOutline:ie,eyeOffOutline:ne,arrowBackOutline:te})}ngOnInit(){let d=this.themeService.isDarkMode().subscribe(t=>{this.darkMode=t});this.subscriptions.push(d)}ngOnDestroy(){this.subscriptions.forEach(d=>d.unsubscribe())}actualizarPassword(){if(!this.currentPassword||!this.newPassword||!this.confirmPassword){this.showToast("Todos los campos son obligatorios","warning");return}if(this.newPassword!==this.confirmPassword){this.showToast("Las contrase\xF1as nuevas no coinciden","warning");return}if(this.newPassword.length<6){this.showToast("La nueva contrase\xF1a debe tener al menos 6 caracteres","warning");return}this.submitting=!0;let d={passwordAntigua:this.currentPassword,passwordNueva:this.newPassword},t=this.autenticacionService.cambiarPassword(d).subscribe({next:e=>{console.log("Respuesta del backend:",e),this.submitting=!1,this.presentarAlertaExito()},error:e=>{this.submitting=!1,console.error("Respuesta de error del backend:",e);let p=e.error||"Ocurri\xF3 un error inesperado.";this.showToast(p,"danger")}});this.subscriptions.push(t)}presentarAlertaExito(){this.alertHeader="Contrase\xF1a Actualizada",this.alertMessage="Tu contrase\xF1a ha sido actualizada. Por seguridad, se cerrar\xE1 tu sesi\xF3n.",this.alertButtons=[{text:"Aceptar",role:"confirm",handler:()=>{this.logout()}}],this.isAlertOpen=!0}logout(){localStorage.clear(),this.router.navigate(["/login"],{replaceUrl:!0})}showToast(d,t){this.toastMessage=d,this.toastColor=t,this.isToastOpen=!0}onToastDismiss(){this.isToastOpen=!1}onAlertDismiss(){this.isAlertOpen=!1}};l.\u0275fac=function(t){return new(t||l)(y(k),y(re),y($))},l.\u0275cmp=v({type:l,selectors:[["app-change-password"]],decls:52,vars:28,consts:[["passwordForm","ngForm"],["slot","start"],["defaultHref","/menu/settings"],["id","main-content",3,"fullscreen"],[1,"content-container"],[1,"page-header"],[1,"header-icon"],["name","lock-closed-outline"],[1,"page-title"],[1,"page-subtitle"],[1,"form-section"],[3,"ngSubmit"],[1,"form-list"],["lines","full",1,"form-item"],["position","stacked"],[1,"password-input-container"],["name","currentPassword","type","password","ngDefaultControl","","placeholder","Introduce tu contrase\xF1a actual","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["name","currentPassword","type","text","ngDefaultControl","","placeholder","Introduce tu contrase\xF1a actual","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["fill","clear","type","button",1,"visibility-toggle",3,"click","disabled"],[3,"name"],["name","newPassword","type","password","ngDefaultControl","","placeholder","Introduce tu nueva contrase\xF1a","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["name","newPassword","type","text","ngDefaultControl","","placeholder","Introduce tu nueva contrase\xF1a","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["lines","none",1,"form-item"],["name","confirmPassword","type","password","ngDefaultControl","","placeholder","Confirma tu nueva contrase\xF1a","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["name","confirmPassword","type","text","ngDefaultControl","","placeholder","Confirma tu nueva contrase\xF1a","required","",3,"ngModel","disabled","ngModelChange",4,"ngIf"],[1,"form-actions"],["expand","block","type","submit",1,"update-button",3,"disabled"],["name","crescent",4,"ngIf"],[4,"ngIf"],[1,"security-info"],[3,"didDismiss","isOpen","header","message","buttons"],["position","top",3,"didDismiss","isOpen","message","duration","color"],["name","currentPassword","type","password","ngDefaultControl","","placeholder","Introduce tu contrase\xF1a actual","required","",3,"ngModelChange","ngModel","disabled"],["name","currentPassword","type","text","ngDefaultControl","","placeholder","Introduce tu contrase\xF1a actual","required","",3,"ngModelChange","ngModel","disabled"],["name","newPassword","type","password","ngDefaultControl","","placeholder","Introduce tu nueva contrase\xF1a","required","",3,"ngModelChange","ngModel","disabled"],["name","newPassword","type","text","ngDefaultControl","","placeholder","Introduce tu nueva contrase\xF1a","required","",3,"ngModelChange","ngModel","disabled"],["name","confirmPassword","type","password","ngDefaultControl","","placeholder","Confirma tu nueva contrase\xF1a","required","",3,"ngModelChange","ngModel","disabled"],["name","confirmPassword","type","text","ngDefaultControl","","placeholder","Confirma tu nueva contrase\xF1a","required","",3,"ngModelChange","ngModel","disabled"],["name","crescent"]],template:function(t,e){if(t&1){let p=w();i(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),f(3,"ion-back-button",2),a(),i(4,"ion-title"),m(5,"Cambiar Contrase\xF1a"),a()()(),i(6,"ion-content",3)(7,"div",4)(8,"div",5)(9,"div",6),f(10,"ion-icon",7),a(),i(11,"h1",8),m(12,"Cambiar Contrase\xF1a"),a(),i(13,"p",9),m(14,"Actualiza tu contrase\xF1a de acceso"),a()(),i(15,"div",10)(16,"form",11,0),h("ngSubmit",function(){return c(p),u(e.actualizarPassword())}),i(18,"ion-list",12)(19,"ion-item",13)(20,"ion-label",14),m(21,"Contrase\xF1a actual *"),a(),i(22,"div",15),x(23,ae,1,2,"ion-input",16)(24,se,1,2,"ion-input",17),i(25,"ion-button",18),h("click",function(){return c(p),u(e.showCurrentPassword=!e.showCurrentPassword)}),f(26,"ion-icon",19),a()()(),i(27,"ion-item",13)(28,"ion-label",14),m(29,"Nueva contrase\xF1a *"),a(),i(30,"div",15),x(31,de,1,2,"ion-input",20)(32,le,1,2,"ion-input",21),i(33,"ion-button",18),h("click",function(){return c(p),u(e.showNewPassword=!e.showNewPassword)}),f(34,"ion-icon",19),a()()(),i(35,"ion-item",22)(36,"ion-label",14),m(37,"Confirmar nueva contrase\xF1a *"),a(),i(38,"div",15),x(39,ce,1,2,"ion-input",23)(40,ue,1,2,"ion-input",24),i(41,"ion-button",18),h("click",function(){return c(p),u(e.showConfirmPassword=!e.showConfirmPassword)}),f(42,"ion-icon",19),a()()()(),i(43,"div",25)(44,"ion-button",26),x(45,ge,1,0,"ion-spinner",27)(46,pe,2,0,"span",28),a()()(),i(47,"div",29)(48,"p"),m(49,"Por tu seguridad, despu\xE9s de cambiar la contrase\xF1a se cerrar\xE1 tu sesi\xF3n y deber\xE1s iniciar sesi\xF3n nuevamente."),a()()()(),i(50,"ion-alert",30),h("didDismiss",function(){return c(p),u(e.onAlertDismiss())}),a(),i(51,"ion-toast",31),h("didDismiss",function(){return c(p),u(e.onToastDismiss())}),a()()}if(t&2){let p=O(17);s(),M("dark-mode",e.darkMode),s(5),M("dark-mode",e.darkMode),r("fullscreen",!0),s(17),r("ngIf",!e.showCurrentPassword),s(),r("ngIf",e.showCurrentPassword),s(),r("disabled",e.submitting),s(),r("name",e.showCurrentPassword?"eye-off-outline":"eye-outline"),s(5),r("ngIf",!e.showNewPassword),s(),r("ngIf",e.showNewPassword),s(),r("disabled",e.submitting),s(),r("name",e.showNewPassword?"eye-off-outline":"eye-outline"),s(5),r("ngIf",!e.showConfirmPassword),s(),r("ngIf",e.showConfirmPassword),s(),r("disabled",e.submitting),s(),r("name",e.showConfirmPassword?"eye-off-outline":"eye-outline"),s(2),r("disabled",e.submitting||!p.valid),s(),r("ngIf",e.submitting),s(),r("ngIf",!e.submitting),s(4),r("isOpen",e.isAlertOpen)("header",e.alertHeader)("message",e.alertMessage)("buttons",e.alertButtons),s(),r("isOpen",e.isToastOpen)("message",e.toastMessage)("duration",3e3)("color",e.toastColor)}},dependencies:[Z,L,B,Y,R,U,X,G,q,N,K,j,H,J,Q,S,I,A,W,T,V,D,z,E,F],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: var(--background-color);font-family:Poppins,sans-serif}.content-container[_ngcontent-%COMP%]{padding:20px;max-width:600px;margin:0 auto}.page-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px;padding:24px 20px;background:linear-gradient(135deg,var(--primary-color),#f0a6c6);border-radius:20px;color:#fff;position:relative;overflow:hidden}.page-header[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%);animation:_ngcontent-%COMP%_shimmer 4s ease-in-out infinite}@keyframes _ngcontent-%COMP%_shimmer{0%,to{transform:translate(-100%) translateY(-100%) rotate(0)}50%{transform:translate(0) translateY(0) rotate(180deg)}}.header-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:#fff3;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;margin:0 auto 16px;position:relative;z-index:2}.header-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:30px;color:#fff}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.3);position:relative;z-index:2}.page-subtitle[_ngcontent-%COMP%]{font-size:14px;margin:0;opacity:.9;text-shadow:0 1px 2px rgba(0,0,0,.3);position:relative;z-index:2}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-list[_ngcontent-%COMP%]{background:var(--card-background);border-radius:16px;overflow:hidden;box-shadow:0 4px 12px #0000001a;margin-bottom:24px}.form-item[_ngcontent-%COMP%]{--background: var(--card-background);--color: var(--text-color);--border-color: var(--border-color);--padding-start: 16px;--padding-end: 16px;--inner-padding-end: 8px}.form-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--text-color)!important;font-weight:600;font-size:14px;margin-bottom:8px}.form-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--color: var(--text-color);--placeholder-color: var(--text-muted);font-size:16px}.password-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.password-input-container[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{flex:1}.password-input-container[_ngcontent-%COMP%]   .visibility-toggle[_ngcontent-%COMP%]{--color: var(--text-muted);--padding-start: 8px;--padding-end: 8px;height:36px}.password-input-container[_ngcontent-%COMP%]   .visibility-toggle[_ngcontent-%COMP%]:hover{--color: var(--primary-color)}.form-actions[_ngcontent-%COMP%]{margin-bottom:24px}.update-button[_ngcontent-%COMP%]{--background: var(--primary-color);--color: white;--border-radius: 12px;height:48px;font-weight:600}.update-button[_ngcontent-%COMP%]:hover:not([disabled]){--background: #d37a9e}.security-info[_ngcontent-%COMP%]{background:rgba(var(--primary-color-rgb),.1);border-left:4px solid var(--primary-color);padding:16px;border-radius:8px}.security-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-color);font-size:14px;margin:0;line-height:1.5}[_nghost-%COMP%]{--background-color: #f5f5f5;--card-background: #ffffff;--text-color: #333333;--text-muted: #666666;--primary-color: #e491b4;--primary-color-rgb: 228, 145, 180;--border-color: rgba(0, 0, 0, .1)}.dark-mode[_ngcontent-%COMP%]{--background-color: #121212;--card-background: #1e1e1e;--text-color: #ffffff;--text-muted: #aaaaaa;--border-color: rgba(255, 255, 255, .1)}@media (max-width: 768px){.content-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{padding:20px 16px;margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:20px}}']});let o=l;return o})();export{ve as ChangePasswordPage};
